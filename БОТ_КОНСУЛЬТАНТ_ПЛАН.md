# Бот-консультант — план (бесплатно, под перенос на хостинг в РФ)

## Ограничения и цели

- **Бесплатно** — без платных API (OpenAI и т.п.).
- **Законодательство РФ** — не используем зарубежные API с обработкой ПДн/серверами вне РФ (OpenAI и аналоги отпадают).
- **Перенос** — позже всё (бот + заявки) переносим на хостинг в РФ вместе с интеграцией Bitrix24.
- **Бот** — красивый, умный, с непростыми сценариями, но **без внешних платных/зарубежных LLM**.

---

## Как сделать «умного» бота бесплатно и легально

**Вариант: сценарии + правила (rule-based + FSM)**

- **Логика:** «намерения» (intents) по ключевым словам/фразам + сценарии с шагами (state machine).
- **Примеры сценариев:** «Узнать про доставку» → ответ из готового текста; «Подобрать товар» → уточнение категории → список вариантов → «Запросить КП»; «Оставить заявку» → сбор имени, телефона, комментария → сохранение (позже в Bitrix24).
- **Красота:** кнопки (Reply Keyboard, Inline), форматирование, эмодзи, короткие понятные сообщения.
- **Никаких API:** всё на своём коде, данные только в Telegram и (после переноса) на вашем сервере/Bitrix24.

Позже на хостинге в РФ при желании можно добавить **российский LLM** (Yandex GPT, GigaChat и т.п., если устраивает политика и стоимость) — архитектура бота это позволит (отдельный модуль «генерация ответа»). Сейчас делаем так, чтобы бот был полноценным и без него.

---

## Что делаем в коде

1. **Webhook для бота** — один endpoint (например `api/telegram-webhook.ts` на Vercel), который принимает обновления от Telegram. При переносе этот же endpoint будет на вашем сервере в РФ.
2. **Движок сценариев** — обработка сообщений и кнопок: определение намерения, переход по шагам сценария, ответы и кнопки. Всё в наших данных (массивы текстов, правила), без вызовов вовне.
3. **Красивый UX** — меню, кнопки «Каталог», «Доставка», «Оставить заявку», «Назад» и т.д.; при необходимости пошаговый сбор данных для заявки.
4. **Готовность к переносу** — конфигурация через переменные окружения (URL приложения, вебхук и т.д.), без привязки к Vercel в логике. Позже добавляем отправку заявок в Bitrix24 (как в BITRIX24_ИНТЕГРАЦИЯ_ПЛАН.md).

---

## Что нужно от тебя для сценариев

Чтобы набросать конкретные сценарии и тексты:

- **Какие темы должен закрывать бот?** (доставка, оплата, ассортимент, запрос КП, контакты, часы работы, что-то ещё?)
- **Какие кнопки/меню хочешь в первом экране?** (например: Каталог, Доставка и оплата, Оставить заявку, Связаться с нами)
- **Есть ли многошаговые сценарии?** (например: выбор категории → товары → «узнать цену» / «оставить заявку»)
- **Тексты:** пришли короткие ответы по каждому пункту (или скажи «сделай черновик, потом поправлю»).

Когда будет этот список — сделаем структуру бота и первый набор сценариев; потом доработаем под перенос и Bitrix24.
